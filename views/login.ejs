<!DOCTYPE html>
<html lang="zh-TW">
<%- include('partials/header') %>

  <body id="app-body"
    class="bg-black text-white m-0 p-0 overflow-x-hidden transition-colors duration-500 font-sans min-h-screen">
    <%- include('partials/navbar') %>
      <main class="pt-20">
        <div class="min-h-[80vh] flex items-center justify-center p-6">
          <div
            class="glass p-12 md:p-16 rounded-[3.5rem] w-full max-w-lg space-y-10 border border-white/10 relative overflow-hidden">
            <div class="absolute top-0 right-0 w-32 h-32 bg-blue-500/10 blur-[60px] rounded-full"></div>
            <div class="absolute bottom-0 left-0 w-32 h-32 bg-purple-500/10 blur-[60px] rounded-full"></div>

            <div class="text-center space-y-4 relative z-10">
              <div
                class="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-6 border border-white/10">
                <span class="material-symbols-rounded text-5xl opacity-40">admin_panel_settings</span>
              </div>
              <h1 class="text-4xl font-light tracking-tight">ADMIN LOGIN</h1>
              <p class="opacity-40 text-sm tracking-widest uppercase">僅限授權管理人員進入</p>
            </div>

            <form onsubmit="handleLogin(event)" class="space-y-8 relative z-10">
              <div class="space-y-6">
                <div class="space-y-2">
                  <label class="text-[10px] uppercase tracking-[0.3em] opacity-30 px-4 font-bold">Account</label>
                  <input id="username" required type="text"
                    class="w-full bg-gray-500/10 border border-gray-500/20 p-5 rounded-[1.5rem] outline-none focus:border-blue-500 focus:bg-gray-500/20 transition-all text-inherit placeholder:text-gray-400 text-lg font-light"
                    placeholder="請輸入帳號">
                </div>
                <div class="space-y-2">
                  <label class="text-[10px] uppercase tracking-[0.3em] opacity-30 px-4 font-bold">Password</label>
                  <input id="password" required type="password"
                    class="w-full bg-gray-500/10 border border-gray-500/20 p-5 rounded-[1.5rem] outline-none focus:border-blue-500 focus:bg-gray-500/20 transition-all text-inherit placeholder:text-gray-400 text-lg font-light"
                    placeholder="請輸入密碼">
                </div>
              </div>
              <button id="login-btn" type="submit"
                class="w-full py-5 rounded-[1.5rem] font-bold tracking-widest uppercase hover:scale-[1.02] transition-all flex items-center justify-center gap-3 shadow-lg shadow-blue-500/20">
                LOGIN SYSTEM
                <span class="material-symbols-rounded text-lg">arrow_forward</span>
              </button>
            </form>
          </div>
        </div>
      </main>
      <%- include('partials/modals') %>
        <script src="/js/main.js"></script>
        <script>

          async function handleLogin(event) {
            event.preventDefault(); // 阻止表單預設跳轉

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const btn = document.getElementById('login-btn');

            // 按鈕回饋
            const originalText = btn.innerHTML;
            btn.innerHTML = 'VERIFYING...';
            btn.disabled = true;

            try {
              const response = await fetch('/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username, password })
              });

              const data = await response.json();

              if (data.success) {
                // 登入成功，跳轉到管理後台
                window.location.href = '/admin/dashboard';
              } else {
                alert('登入失敗：' + data.message);
                btn.innerHTML = originalText;
                btn.disabled = false;
              }
            } catch (error) {
              console.error(error);
              alert('系統錯誤，請稍後再試');
              btn.innerHTML = originalText;
              btn.disabled = false;
            }
          }
        </script>
  </body>

</html>